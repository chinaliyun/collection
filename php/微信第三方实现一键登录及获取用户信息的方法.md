<section data-style="text-align: justify; line-height: 1.75em; white-space: normal;color: rgb(63, 63, 63); font-size: 14px;" class="" style="margin-top: -16px; padding: 30px 15px 15px; max-width: 100%; box-sizing: border-box; border: 2px solid rgb(255, 129, 36); word-wrap: break-word !important;">
    <p style="text-align: left; text-indent: 2em;">本文实例讲述了PHP版微信第三方实现一键登录及获取用户信息的方法。分享给大家供大家参考，具体如下：</p>
    <p style="text-align: left; text-indent: 2em;">注意，要使用微信在第三方网页登录是需要“服务号”才可以哦，所以必须到官方申请</p>
    <p style="text-align: left; text-indent: 2em;">一开始你需要进入微信公众平台开启开发模式,并且填写oauth2的回调地址,地址填写你项目的域名就可以了.比如:www.baidu.com或zhidao.baidu.com.如果你的项目在二级域名就写二级域名</p>
    <p style="text-align: left; text-indent: 2em;">前端url授权地址,在url中填写appid与你项目中方法中的oauth的地址,具体在下面的代码中可以看到.</p>
    <p style="max-width: 100%; min-height: 1em; font-size: 14px; list-style: none outside none; color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 26px; box-sizing: border-box !important; word-wrap: break-word !important; text-align: left; background-color: rgb(252, 252, 252);"><span style="color: rgb(255, 0, 0);">&lt;a href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=appid&amp;redirect_uri=http://www.xxxxxx.com/action/function/oauth2&amp;response_type=code&amp;scope=snsapi_userinfo&amp;state=1#wechat_redirect"&gt;授权&lt;/a&gt;</span></p>
    <p style="max-width: 100%; min-height: 1em; font-size: 14px; list-style: none outside none; color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 26px; box-sizing: border-box !important; word-wrap: break-word !important; text-align: left; background-color: rgb(252, 252, 252);">
        <br>
    </p>
    <p style="text-align: left;">再说后台逻辑,首先调用微信接口的SDK.(后面会有)</p>
    <p style="text-align: left;"><span style="color: rgb(255, 0, 0);">include('./Card/Common/class_weixin_adv.php');</span></p>
    <p style="text-align: left;">之后填入微信官方给的的appid与secret</p>
    <p style="text-align: left;"><span style="color: rgb(255, 0, 0);">$weixin=new class_weixin_adv("appid", "secret");</span></p>
    <p style="text-align: left;">初始化SDK的类,取到code,利用获取到的code在获取出openid 看下面代码注释!</p>
    <p style="text-align: left;"><img data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/QibLP1rpwH8vYFrNT8hsaZxdoSo0smobfyVUcxiaTeTmwquviaaMCFA7rf7zetRIAldlTuqHlmOg8Ra3x6ITibN5Xg/0?wx_fmt=png" style="width: 100% !important; height: auto !important; visibility: visible !important;" data-ratio="0.14868309260832624" data-w="1177" _width="100%" src="http://mmbiz.qpic.cn/mmbiz_png/QibLP1rpwH8vYFrNT8hsaZxdoSo0smobfyVUcxiaTeTmwquviaaMCFA7rf7zetRIAldlTuqHlmOg8Ra3x6ITibN5Xg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" data-fail="0"><span style="text-align: left; line-height: 28.4444px;">继续调用SDK方法,获取到用户信息.此时$row已经获得用户信息了 可以var_dump下看看键值方便存入数据库</span></p>
    <p style="text-align: left;"><span style="color: rgb(255, 0, 0);">$row=$weixin-&gt;get_user_info($res['openid']);</span></p>
    <p style="text-align: left; text-indent: 2em;">获取用户信息就大功告成了,但这还不够.我们需要的是无需注册!所以需要利用openid,openid属于唯一凭证,每个用户对不同的公众号都有不同的openid.可以理解成用户账号的感觉.我这里用的是把openid存入cookie的解决方案,类似用户登陆的感觉,一些关键数据验证只需要与数据库中的openid进行对比.其他的一些利用方法可以发挥大家的想象!可以跟我留言交流!</p>
    <p style="text-align: left; text-indent: 2em;">关于之前的a链接的授权,大家也可以判断cookie是否存在openid,从而让未授权用户直接跳转到该地址,省却了用户的一步操作.</p>
    <p style="text-align: left;">下面是完整逻辑代码,大家可以参考下!</p>
    <p><img data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/QibLP1rpwH8vYFrNT8hsaZxdoSo0smobfmMKwxtrS1J5VlicSERtFXT1ETpAplBatmOhMxv9GSiavVbhS0licx0ELQ/0?wx_fmt=png" style="width: 100% !important; height: auto !important; visibility: visible !important;" data-ratio="0.7111111111111111" data-w="1080" _width="100%" src="http://mmbiz.qpic.cn/mmbiz_png/QibLP1rpwH8vYFrNT8hsaZxdoSo0smobfmMKwxtrS1J5VlicSERtFXT1ETpAplBatmOhMxv9GSiavVbhS0licx0ELQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" data-fail="0"></p>
    <p style="text-align: left;">SDK代码:微信官方有手册,我就不多讲了,自己研究,很简单的!</p>
    <p><img data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/QibLP1rpwH8vYFrNT8hsaZxdoSo0smobfELncaic61mRKkau1iaxZfmicGsYiblrfvmiboZusZ5L45JFle7SgjGUEDfA/0?wx_fmt=png" style="width: 100% !important; height: auto !important; visibility: visible !important;" data-ratio="0.8620689655172413" data-w="870" _width="100%" src="http://mmbiz.qpic.cn/mmbiz_png/QibLP1rpwH8vYFrNT8hsaZxdoSo0smobfELncaic61mRKkau1iaxZfmicGsYiblrfvmiboZusZ5L45JFle7SgjGUEDfA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" data-fail="0"></p>
    <p><img data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/QibLP1rpwH8vYFrNT8hsaZxdoSo0smobfnP7CJwthKj1c3ywWuhUCSWyuNXSa6EdgzLzfx4yZQQaushSavYicibQA/0?wx_fmt=png" style="width: 100% !important; height: auto !important; visibility: visible !important;" data-ratio="0.7157894736842105" data-w="855" _width="100%" src="http://mmbiz.qpic.cn/mmbiz_png/QibLP1rpwH8vYFrNT8hsaZxdoSo0smobfnP7CJwthKj1c3ywWuhUCSWyuNXSa6EdgzLzfx4yZQQaushSavYicibQA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" data-fail="0"></p>
</section>
